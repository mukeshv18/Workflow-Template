name: Publish JAR Artifact (reusable)

on:
  workflow_call:
    inputs:
      artifact_name:
        description: 'Name for the uploaded artifact (zip).'
        required: false
        default: 'application-jar-zip'
      skip_tests:
        description: 'If "true", skip running tests during build.'
        required: false
        default: 'true'
    secrets:
      GITHUB_TOKEN:
        required: true

jobs:
  Zip-and-publish:
      - name: Package found JAR into a zip
        id: create_zip
        run: |
          set -e
          mkdir -p artifact
          cp "${{ steps.find_jar.outputs.jar_path }}" artifact/
          ZIP_NAME="${{ github.job }}-${{ github.run_number }}.zip"
          cd artifact
          zip -r "$ZIP_NAME" .
          # expose zip path as output
          echo "zip_path=artifact/$ZIP_NAME" >> $GITHUB_OUTPUT

      - name: Upload zipped artifact
        uses: actions/upload-artifact@v4
        with:
          name: ${{ inputs.artifact_name }}
          path: ${{ steps.create_zip.outputs.zip_path }}
          retention-days: 7
